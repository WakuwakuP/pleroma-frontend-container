(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{1025:function(t,e,s){"use strict";s.d(e,"a",(function(){return z}));var a=s(0),i=s(1),o=s.n(i),n=s(3),d=s.n(n),l=s(16),r=s.n(l),c=s(226),h=s(236),u=s(287),p=s(850),g=s(353),m=s(618),b=s(4),f=s(968),v=s(18),k=s(90),O=s(350),M=s(391),_=s(975),y=s(7),j=s.n(y),C=s(988),I=s(28),x=s(403),w=s(977),R=s(12),H=s(402),D=s(397),E=s(978);var T,S=Object(R.connect)(((t,e)=>{let{statusId:s}=e;return{dropdownPlacement:t.getIn(["dropdown_menu","placement"]),openDropdownId:t.getIn(["dropdown_menu","openId"]),openedViaKeyboard:t.getIn(["dropdown_menu","keyboard"]),items:t.getIn(["history",s,"items"]),loading:t.getIn(["history",s,"loading"])}}),((t,e)=>{let{statusId:s}=e;return{onOpen(e,a,i,o){t(Object(D.d)(s)),t(Object(H.d)(e,i,o))},onClose(e){t(Object(H.c)(e))}}}))(E.a),B=s(51),N=s(139),P=s(979);let F=Object(R.connect)(null,((t,e)=>{let{statusId:s}=e;return{onItemClick(e){t(Object(B.d)("COMPARE_HISTORY",{index:e,statusId:s}))}}}))(T=Object(b.g)(T=class extends o.a.PureComponent{constructor(){super(...arguments),this.handleItemClick=(t,e)=>{const{onItemClick:s}=this.props;s(e)},this.renderHeader=t=>Object(a.a)(b.b,{id:"status.edited_x_times",defaultMessage:"Edited {count, plural, one {{count} time} other {{count} times}}",values:{count:t.size-1}}),this.renderItem=(t,e,s)=>{let{onClick:i,onKeyPress:o}=s;const n=Object(a.a)(N.default,{timestamp:t.get("created_at"),short:!1}),d=Object(a.a)(P.a,{accountId:t.get("account")}),l=t.get("original")?Object(a.a)(b.b,{id:"status.history.created",defaultMessage:"{name} created {date}",values:{name:d,date:n}}):Object(a.a)(b.b,{id:"status.history.edited",defaultMessage:"{name} edited {date}",values:{name:d,date:n}});return Object(a.a)("li",{className:"dropdown-menu__item edited-timestamp__history__item"},t.get("created_at"),Object(a.a)("button",{"data-index":e,onClick:i,onKeyPress:o},void 0,l))}}render(){const{timestamp:t,intl:e,statusId:s}=this.props;return Object(a.a)(S,{statusId:s,renderItem:this.renderItem,scrollable:!0,renderHeader:this.renderHeader,onItemClick:this.handleItemClick},void 0,Object(a.a)("button",{className:"dropdown-menu__text-button"},void 0,Object(a.a)(b.b,{id:"status.edited",defaultMessage:"Edited {date}",values:{date:e.formatDate(t,{hour12:!1,month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}})," ",Object(a.a)(I.a,{id:"caret-down"})))}})||T)||T;var V,A;let z=Object(b.g)(((A=class extends v.a{constructor(){super(...arguments),this.state={height:null},this.handleAccountClick=t=>{if(0===t.button&&!(t.ctrlKey||t.altKey||t.metaKey)&&this.context.router){t.preventDefault();let e={...this.context.router.history.location.state};e.mastodonBackSteps=(e.mastodonBackSteps||0)+1,this.context.router.history.push("/@"+this.props.status.getIn(["account","acct"]),e)}t.stopPropagation()},this.parseClick=(t,e)=>{if(0===t.button&&!(t.ctrlKey||t.altKey||t.metaKey)&&this.context.router){t.preventDefault();let s={...this.context.router.history.location.state};s.mastodonBackSteps=(s.mastodonBackSteps||0)+1,this.context.router.history.push(e,s)}t.stopPropagation()},this.handleOpenVideo=t=>{this.props.onOpenVideo(this.props.status.getIn(["media_attachments",0]),t)},this.setRef=t=>{this.node=t,this._measureHeight()},this.handleChildUpdate=()=>{this._measureHeight()},this.handleModalLink=t=>{let e;t.preventDefault(),e="A"!==t.target.nodeName?t.target.parentNode.href:t.target.href,window.open(e,"mastodon-intent","width=445,height=600,resizable=no,menubar=no,status=no,scrollbars=yes")}}_measureHeight(t){this.props.measureHeight&&this.node&&(Object(_.a)((()=>this.node&&this.setState({height:Math.ceil(this.node.scrollHeight)+1}))),this.props.onHeightChange&&t&&this.props.onHeightChange())}componentDidUpdate(t,e){this._measureHeight(e.height!==this.state.height)}render(){const t=this.props.status&&this.props.status.get("reblog")?this.props.status.get("reblog"):this.props.status,{expanded:e,onToggleHidden:s,settings:i,usingPiP:n,intl:d}=this.props,l={boxSizing:"border-box"},{compact:r}=this.props;if(!t)return null;let v="",_="",y="retweet",R="",H="",D=[],E=[],T=[],S=[],B=D,N=E;if(i.getIn(["content_warnings","media_outside"])&&(B=T,N=S),this.props.measureHeight&&(l.height=this.state.height+"px"),n)B.push(Object(a.a)(w.a,{})),N.push("video-camera");else if(t.get("media_attachments").size>0)if(t.get("media_attachments").some((t=>"unknown"===t.get("type"))))B.push(Object(a.a)(g.a,{media:t.get("media_attachments")}));else if("audio"===t.getIn(["media_attachments",0,"type"])){const e=t.getIn(["media_attachments",0]);B.push(Object(a.a)(O.default,{src:e.get("url"),alt:e.get("description"),duration:e.getIn(["meta","original","duration"],0),poster:e.get("preview_url")||t.getIn(["account","avatar_static"]),backgroundColor:e.getIn(["meta","colors","background"]),foregroundColor:e.getIn(["meta","colors","foreground"]),accentColor:e.getIn(["meta","colors","accent"]),sensitive:t.get("sensitive"),visible:this.props.showMedia,blurhash:e.get("blurhash"),height:150,onToggleVisibility:this.props.onToggleMediaVisibility})),N.push("music")}else if("video"===t.getIn(["media_attachments",0,"type"])){const s=t.getIn(["media_attachments",0]);B.push(Object(a.a)(k.default,{preview:s.get("preview_url"),frameRate:s.getIn(["meta","original","frame_rate"]),blurhash:s.get("blurhash"),src:s.get("url"),alt:s.get("description"),inline:!0,sensitive:t.get("sensitive"),letterbox:i.getIn(["media","letterbox"]),fullwidth:i.getIn(["media","fullwidth"]),preventPlayback:!e,onOpenVideo:this.handleOpenVideo,autoplay:!0,visible:this.props.showMedia,onToggleVisibility:this.props.onToggleMediaVisibility})),N.push("video-camera")}else B.push(Object(a.a)(p.default,{standalone:!0,sensitive:t.get("sensitive"),media:t.get("media_attachments"),letterbox:i.getIn(["media","letterbox"]),fullwidth:i.getIn(["media","fullwidth"]),hidden:!e,onOpenMedia:this.props.onOpenMedia,visible:this.props.showMedia,onToggleVisibility:this.props.onToggleMediaVisibility})),N.push("picture-o");else t.get("card")&&(B.push(Object(a.a)(f.a,{sensitive:t.get("sensitive"),onOpenMedia:this.props.onOpenMedia,card:t.get("card")})),N.push("link"));t.get("poll")&&(D.push(Object(a.a)(C.a,{pollId:t.get("poll")})),E.push("tasks")),t.get("application")&&(v=Object(a.a)(o.a.Fragment,{},void 0," · ",Object(a.a)("a",{className:"detailed-status__application",href:t.getIn(["application","website"]),target:"_blank",rel:"noopener noreferrer"},void 0,t.getIn(["application","name"]))));const P=Object(a.a)(o.a.Fragment,{},void 0," · ",Object(a.a)(M.a,{visibility:t.get("visibility")}));return"direct"===t.get("visibility")?y="envelope":"private"===t.get("visibility")&&(y="lock"),_=["unlisted","public"].includes(t.get("visibility"))?this.context.router?Object(a.a)(o.a.Fragment,{},void 0,Object(a.a)(o.a.Fragment,{},void 0," · "),Object(a.a)(m.a,{to:"/@"+t.getIn(["account","acct"])+"/"+t.get("id")+"/reblogs",className:"detailed-status__link"},void 0,Object(a.a)(I.a,{id:y}),Object(a.a)("span",{className:"detailed-status__reblogs"},void 0,Object(a.a)(x.a,{value:t.get("reblogs_count")})))):Object(a.a)(o.a.Fragment,{},void 0,Object(a.a)(o.a.Fragment,{},void 0," · "),Object(a.a)("a",{href:"/interact/"+t.get("id")+"?type=reblog",className:"detailed-status__link",onClick:this.handleModalLink},void 0,Object(a.a)(I.a,{id:y}),Object(a.a)("span",{className:"detailed-status__reblogs"},void 0,Object(a.a)(x.a,{value:t.get("reblogs_count")})))):null,R=this.context.router?Object(a.a)(m.a,{to:"/@"+t.getIn(["account","acct"])+"/"+t.get("id")+"/favourites",className:"detailed-status__link"},void 0,Object(a.a)(I.a,{id:"star"}),Object(a.a)("span",{className:"detailed-status__favorites"},void 0,Object(a.a)(x.a,{value:t.get("favourites_count")}))):Object(a.a)("a",{href:"/interact/"+t.get("id")+"?type=favourite",className:"detailed-status__link",onClick:this.handleModalLink},void 0,Object(a.a)(I.a,{id:"star"}),Object(a.a)("span",{className:"detailed-status__favorites"},void 0,Object(a.a)(x.a,{value:t.get("favourites_count")}))),t.get("edited_at")&&(H=Object(a.a)(o.a.Fragment,{},void 0,Object(a.a)(o.a.Fragment,{},void 0," · "),Object(a.a)(F,{statusId:t.get("id"),timestamp:t.get("edited_at")}))),Object(a.a)("div",{style:l},void 0,o.a.createElement("div",{ref:this.setRef,className:j()("detailed-status","detailed-status-"+t.get("visibility"),{compact:r}),"data-status-by":t.getIn(["account","acct"])},Object(a.a)("a",{href:t.getIn(["account","url"]),onClick:this.handleAccountClick,className:"detailed-status__display-name"},void 0,Object(a.a)("div",{className:"detailed-status__display-avatar"},void 0,Object(a.a)(c.a,{account:t.get("account"),size:48})),Object(a.a)(h.a,{account:t.get("account"),localDomain:this.props.domain})),Object(a.a)(u.a,{status:t,media:D,extraMedia:T,mediaIcons:E,expanded:e,collapsed:!1,onExpandedToggle:s,parseClick:this.parseClick,onUpdate:this.handleChildUpdate,tagLinks:i.get("tag_misleading_links"),rewriteMentions:i.get("rewrite_mentions"),disabled:!0}),Object(a.a)("div",{className:"detailed-status__meta"},void 0,Object(a.a)("a",{className:"detailed-status__datetime",href:t.get("url"),target:"_blank",rel:"noopener noreferrer"},void 0,Object(a.a)(b.a,{value:new Date(t.get("created_at")),hour12:!1,year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})),H,P,v,_," · ",R)))}}).contextTypes={router:d.a.object},A.propTypes={status:r.a.map,settings:r.a.map.isRequired,onOpenMedia:d.a.func.isRequired,onOpenVideo:d.a.func.isRequired,onToggleHidden:d.a.func,expanded:d.a.bool,measureHeight:d.a.bool,onHeightChange:d.a.func,domain:d.a.string.isRequired,compact:d.a.bool,showMedia:d.a.bool,usingPiP:d.a.bool,onToggleMediaVisibility:d.a.func,intl:d.a.object.isRequired},V=A))||V},1132:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return Z}));var a,i,o=s(0),n=s(2),d=s(1),l=s.n(d),r=s(12),c=s(3),h=s.n(c),u=s(7),p=s.n(u),g=s(16),m=s.n(g),b=s(39),f=s(204),v=s(1310),k=s(1025),O=s(45),M=s(1324),_=s(4),y=s(14),j=s(372),C=s(1325);const I=Object(_.f)({delete:{id:"status.delete",defaultMessage:"Delete"},redraft:{id:"status.redraft",defaultMessage:"Delete & re-draft"},edit:{id:"status.edit",defaultMessage:"Edit"},direct:{id:"status.direct",defaultMessage:"Direct message @{name}"},mention:{id:"status.mention",defaultMessage:"Mention @{name}"},reply:{id:"status.reply",defaultMessage:"Reply"},reblog:{id:"status.reblog",defaultMessage:"Boost"},reblog_private:{id:"status.reblog_private",defaultMessage:"Boost with original visibility"},cancel_reblog_private:{id:"status.cancel_reblog_private",defaultMessage:"Unboost"},cannot_reblog:{id:"status.cannot_reblog",defaultMessage:"This post cannot be boosted"},favourite:{id:"status.favourite",defaultMessage:"Favourite"},bookmark:{id:"status.bookmark",defaultMessage:"Bookmark"},more:{id:"status.more",defaultMessage:"More"},mute:{id:"status.mute",defaultMessage:"Mute @{name}"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"},block:{id:"status.block",defaultMessage:"Block @{name}"},report:{id:"status.report",defaultMessage:"Report @{name}"},share:{id:"status.share",defaultMessage:"Share"},pin:{id:"status.pin",defaultMessage:"Pin on profile"},unpin:{id:"status.unpin",defaultMessage:"Unpin from profile"},embed:{id:"status.embed",defaultMessage:"Embed"},admin_account:{id:"status.admin_account",defaultMessage:"Open moderation interface for @{name}"},admin_status:{id:"status.admin_status",defaultMessage:"Open this status in the moderation interface"},copy:{id:"status.copy",defaultMessage:"Copy link to status"}});let x=Object(_.g)(((i=class extends l.a.PureComponent{constructor(){super(...arguments),this.handleReplyClick=()=>{this.props.onReply(this.props.status)},this.handleReblogClick=t=>{this.props.onReblog(this.props.status,t)},this.handleFavouriteClick=t=>{this.props.onFavourite(this.props.status,t)},this.handleBookmarkClick=t=>{this.props.onBookmark(this.props.status,t)},this.handleDeleteClick=()=>{this.props.onDelete(this.props.status,this.context.router.history)},this.handleRedraftClick=()=>{this.props.onDelete(this.props.status,this.context.router.history,!0)},this.handleEditClick=()=>{this.props.onEdit(this.props.status,this.context.router.history)},this.handleDirectClick=()=>{this.props.onDirect(this.props.status.get("account"),this.context.router.history)},this.handleMentionClick=()=>{this.props.onMention(this.props.status.get("account"),this.context.router.history)},this.handleMuteClick=()=>{this.props.onMute(this.props.status.get("account"))},this.handleConversationMuteClick=()=>{this.props.onMuteConversation(this.props.status)},this.handleBlockClick=()=>{this.props.onBlock(this.props.status)},this.handleReport=()=>{this.props.onReport(this.props.status)},this.handlePinClick=()=>{this.props.onPin(this.props.status)},this.handleShare=()=>{navigator.share({text:this.props.status.get("search_index"),url:this.props.status.get("url")})},this.handleEmbed=()=>{this.props.onEmbed(this.props.status)},this.handleCopy=()=>{const t=this.props.status.get("url"),e=document.createElement("textarea");e.textContent=t,e.style.position="fixed",document.body.appendChild(e);try{e.select(),document.execCommand("copy")}catch(t){}finally{document.body.removeChild(e)}}}render(){const{status:t,intl:e}=this.props,s=["public","unlisted"].includes(t.get("visibility")),a=["public","unlisted","private"].includes(t.get("visibility")),i=t.get("muted"),n=t.getIn(["account","id"])===y.me;let d=[];s&&(d.push({text:e.formatMessage(I.copy),action:this.handleCopy}),d.push({text:e.formatMessage(I.embed),action:this.handleEmbed}),d.push(null)),n?(a&&(d.push({text:e.formatMessage(t.get("pinned")?I.unpin:I.pin),action:this.handlePinClick}),d.push(null)),d.push({text:e.formatMessage(i?I.unmuteConversation:I.muteConversation),action:this.handleConversationMuteClick}),d.push(null),d.push({text:e.formatMessage(I.delete),action:this.handleDeleteClick}),d.push({text:e.formatMessage(I.redraft),action:this.handleRedraftClick})):(d.push({text:e.formatMessage(I.mention,{name:t.getIn(["account","username"])}),action:this.handleMentionClick}),d.push({text:e.formatMessage(I.direct,{name:t.getIn(["account","username"])}),action:this.handleDirectClick}),d.push(null),d.push({text:e.formatMessage(I.mute,{name:t.getIn(["account","username"])}),action:this.handleMuteClick}),d.push({text:e.formatMessage(I.block,{name:t.getIn(["account","username"])}),action:this.handleBlockClick}),d.push({text:e.formatMessage(I.report,{name:t.getIn(["account","username"])}),action:this.handleReport}),(this.context.identity.permissions&C.c)===C.c&&(j.a||j.i)&&(d.push(null),void 0!==j.a&&d.push({text:e.formatMessage(I.admin_account,{name:t.getIn(["account","username"])}),href:Object(j.a)(t.getIn(["account","id"]))}),void 0!==j.i&&d.push({text:e.formatMessage(I.admin_status),href:Object(j.i)(t.getIn(["account","id"]),t.get("id"))})));const l="share"in navigator&&s&&Object(o.a)("div",{className:"detailed-status__button"},void 0,Object(o.a)(O.a,{title:e.formatMessage(I.share),icon:"share-alt",onClick:this.handleShare})),r=t.getIn(["account","id"])===y.me&&"private"===t.get("visibility");let c;return c=t.get("reblogged")?e.formatMessage(I.cancel_reblog_private):s?e.formatMessage(I.reblog):r?e.formatMessage(I.reblog_private):e.formatMessage(I.cannot_reblog),Object(o.a)("div",{className:"detailed-status__action-bar"},void 0,Object(o.a)("div",{className:"detailed-status__button"},void 0,Object(o.a)(O.a,{title:e.formatMessage(I.reply),icon:null===t.get("in_reply_to_id",null)?"reply":"reply-all",onClick:this.handleReplyClick})),Object(o.a)("div",{className:"detailed-status__button"},void 0,Object(o.a)(O.a,{className:p()({reblogPrivate:r}),disabled:!s&&!r,active:t.get("reblogged"),title:c,icon:"retweet",onClick:this.handleReblogClick})),Object(o.a)("div",{className:"detailed-status__button"},void 0,Object(o.a)(O.a,{className:"star-icon",animate:!0,active:t.get("favourited"),title:e.formatMessage(I.favourite),icon:"star",onClick:this.handleFavouriteClick})),l,Object(o.a)("div",{className:"detailed-status__button"},void 0,Object(o.a)(O.a,{className:"bookmark-icon",active:t.get("bookmarked"),title:e.formatMessage(I.bookmark),icon:"bookmark",onClick:this.handleBookmarkClick})),Object(o.a)("div",{className:"detailed-status__action-bar-dropdown"},void 0,Object(o.a)(M.a,{size:18,icon:"ellipsis-h",items:d,direction:"left",title:e.formatMessage(I.more)})))}}).contextTypes={router:h.a.object,identity:h.a.object},a=i))||a;var w,R,H,D=s(1292),E=s(57),T=s(17),S=s(419),B=s(141),N=s(234),P=s(965),F=s(277),V=s(143),A=s(1339),z=s(1435),U=s(1294),q=s(1348),K=s(51),L=s(18),J=s(616),W=s(358),Y=s(572),G=s(1378),Q=s(28);const X=Object(_.f)({deleteConfirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},deleteMessage:{id:"confirmations.delete.message",defaultMessage:"Are you sure you want to delete this status?"},redraftConfirm:{id:"confirmations.redraft.confirm",defaultMessage:"Delete & redraft"},redraftMessage:{id:"confirmations.redraft.message",defaultMessage:"Are you sure you want to delete this status and re-draft it? You will lose all replies, boosts and favourites to it."},revealAll:{id:"status.show_more_all",defaultMessage:"Show more for all"},hideAll:{id:"status.show_less_all",defaultMessage:"Show less for all"},detailedStatus:{id:"status.detailed_status",defaultMessage:"Detailed conversation view"},replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"},tootHeading:{id:"column.toot",defaultMessage:"Toots and replies"}});let Z=(w=Object(r.connect)((()=>{const t=Object(V.h)(),e=Object(b.a)([(t,e)=>{let{id:s}=e;return s},t=>t.getIn(["contexts","inReplyTos"])],((t,e)=>{let s=n.default.List();return s=s.withMutations((s=>{let a=t;for(;a&&!s.includes(a);)s.unshift(a),a=e.get(a)})),s})),s=Object(b.a)([(t,e)=>{let{id:s}=e;return s},t=>t.getIn(["contexts","replies"]),t=>t.get("statuses")],((t,e,s)=>{let a=[];const i=[t];for(;i.length>0;){let s=i.pop();const o=e.get(s);t!==s&&a.push(s),o&&o.reverse().forEach((e=>{i.includes(e)||a.includes(e)||t===e||i.push(e)}))}let o=a.findIndex((t=>s.get(t).get("in_reply_to_account_id")!==s.get(t).get("account")));return-1!==o&&a.forEach(((t,e)=>{e>o&&s.get(t).get("in_reply_to_account_id")===s.get(t).get("account")&&(a.splice(e,1),a.splice(o,0,t),o+=1)})),n.default.List(a)}));return(a,i)=>{const o=t(a,{id:i.params.statusId});let d=n.default.List(),l=n.default.List();return o&&(d=e(a,{id:o.get("in_reply_to_id")}),l=s(a,{id:o.get("id")})),{status:o,ancestorsIds:d,descendantsIds:l,settings:a.get("local_settings"),askReplyConfirmation:a.getIn(["local_settings","confirm_before_clearing_draft"])&&0!==a.getIn(["compose","text"]).trim().length,domain:a.getIn(["meta","domain"]),usingPiP:a.get("picture_in_picture").statusId===i.params.statusId}}})),Object(_.g)(R=w(((H=class extends L.a{constructor(){var t;super(...arguments),t=this,this.state={fullscreen:!1,isExpanded:void 0,threadExpanded:void 0,statusId:void 0,loadedStatusId:void 0,showMedia:void 0,revealBehindCW:void 0},this.handleToggleHidden=()=>{const{status:t}=this.props;this.props.settings.getIn(["content_warnings","shared_state"])?t.get("hidden")?this.props.dispatch(Object(f.m)(t.get("id"))):this.props.dispatch(Object(f.k)(t.get("id"))):this.props.status.get("spoiler_text")&&this.setExpansion(!this.state.isExpanded)},this.handleToggleMediaVisibility=()=>{this.setState({showMedia:!this.state.showMedia})},this.handleModalFavourite=t=>{this.props.dispatch(Object(E.p)(t))},this.handleFavouriteClick=(t,e)=>{t.get("favourited")?this.props.dispatch(Object(E.v)(t)):e&&e.shiftKey||!y.favouriteModal?this.handleModalFavourite(t):this.props.dispatch(Object(K.d)("FAVOURITE",{status:t,onFavourite:this.handleModalFavourite}))},this.handlePin=t=>{t.get("pinned")?this.props.dispatch(Object(E.w)(t)):this.props.dispatch(Object(E.s)(t))},this.handleReplyClick=t=>{let{askReplyConfirmation:e,dispatch:s,intl:a}=this.props;s(e?Object(K.d)("CONFIRM",{message:a.formatMessage(X.replyMessage),confirm:a.formatMessage(X.replyConfirm),onDoNotAsk:()=>s(Object(S.c)(["confirm_before_clearing_draft"],!1)),onConfirm:()=>s(Object(T.Ab)(t,this.context.router.history))}):Object(T.Ab)(t,this.context.router.history))},this.handleModalReblog=(t,e)=>{const{dispatch:s}=this.props;t.get("reblogged")?s(Object(E.x)(t)):s(Object(E.t)(t,e))},this.handleReblogClick=(t,e)=>{const{settings:s,dispatch:a}=this.props;s.get("confirm_boost_missing_media_description")&&t.get("media_attachments").some((t=>!t.get("description")))&&!t.get("reblogged")?a(Object(F.d)({status:t,onReblog:this.handleModalReblog,missingMediaDescription:!0})):e&&e.shiftKey||!y.boostModal?this.handleModalReblog(t):a(Object(F.d)({status:t,onReblog:this.handleModalReblog}))},this.handleBookmarkClick=t=>{t.get("bookmarked")?this.props.dispatch(Object(E.u)(t)):this.props.dispatch(Object(E.o)(t))},this.handleDeleteClick=function(e,s,a){void 0===a&&(a=!1);const{dispatch:i,intl:o}=t.props;y.deleteModal?i(Object(K.d)("CONFIRM",{message:o.formatMessage(a?X.redraftMessage:X.deleteMessage),confirm:o.formatMessage(a?X.redraftConfirm:X.deleteConfirm),onConfirm:()=>i(Object(f.h)(e.get("id"),s,a))})):i(Object(f.h)(e.get("id"),s,a))},this.handleEditClick=(t,e)=>{this.props.dispatch(Object(f.i)(t.get("id"),e))},this.handleDirectClick=(t,e)=>{this.props.dispatch(Object(T.nb)(t,e))},this.handleMentionClick=(t,e)=>{this.props.dispatch(Object(T.ub)(t,e))},this.handleOpenMedia=(t,e)=>{this.props.dispatch(Object(K.d)("MEDIA",{statusId:this.props.status.get("id"),media:t,index:e}))},this.handleOpenVideo=(t,e)=>{this.props.dispatch(Object(K.d)("VIDEO",{statusId:this.props.status.get("id"),media:t,options:e}))},this.handleHotkeyOpenMedia=t=>{const{status:e}=this.props;t.preventDefault(),e.get("media_attachments").size>0&&("video"===e.getIn(["media_attachments",0,"type"])?this.handleOpenVideo(e.getIn(["media_attachments",0]),{startTime:0}):this.handleOpenMedia(e.get("media_attachments"),0))},this.handleMuteClick=t=>{this.props.dispatch(Object(B.m)(t))},this.handleConversationMuteClick=t=>{t.get("muted")?this.props.dispatch(Object(f.n)(t.get("id"))):this.props.dispatch(Object(f.l)(t.get("id")))},this.handleToggleAll=()=>{const{status:t,ancestorsIds:e,descendantsIds:s,settings:a}=this.props,i=[t.get("id")].concat(e.toJS(),s.toJS());let{isExpanded:o}=this.state;a.getIn(["content_warnings","shared_state"])&&(o=!t.get("hidden")),o?this.props.dispatch(Object(f.k)(i)):this.props.dispatch(Object(f.m)(i)),this.setState({isExpanded:!o,threadExpanded:!o})},this.handleBlockClick=t=>{const{dispatch:e}=this.props,s=t.get("account");e(Object(N.j)(s))},this.handleReport=t=>{this.props.dispatch(Object(P.a)(t.get("account"),t))},this.handleEmbed=t=>{this.props.dispatch(Object(K.d)("EMBED",{url:t.get("url")}))},this.handleHotkeyToggleSensitive=()=>{this.handleToggleMediaVisibility()},this.handleHotkeyMoveUp=()=>{this.handleMoveUp(this.props.status.get("id"))},this.handleHotkeyMoveDown=()=>{this.handleMoveDown(this.props.status.get("id"))},this.handleHotkeyReply=t=>{t.preventDefault(),this.handleReplyClick(this.props.status)},this.handleHotkeyFavourite=()=>{this.handleFavouriteClick(this.props.status)},this.handleHotkeyBoost=()=>{this.handleReblogClick(this.props.status)},this.handleHotkeyBookmark=()=>{this.handleBookmarkClick(this.props.status)},this.handleHotkeyMention=t=>{t.preventDefault(),this.handleMentionClick(this.props.status)},this.handleHotkeyOpenProfile=()=>{let t={...this.context.router.history.location.state};t.mastodonBackSteps=(t.mastodonBackSteps||0)+1,this.context.router.history.push("/@"+this.props.status.getIn(["account","acct"]),t)},this.handleMoveUp=t=>{const{status:e,ancestorsIds:s,descendantsIds:a}=this.props;if(t===e.get("id"))this._selectChild(s.size-1,!0);else{let e=s.indexOf(t);-1===e?(e=a.indexOf(t),this._selectChild(s.size+e,!0)):this._selectChild(e-1,!0)}},this.handleMoveDown=t=>{const{status:e,ancestorsIds:s,descendantsIds:a}=this.props;if(t===e.get("id"))this._selectChild(s.size+1,!1);else{let e=s.indexOf(t);-1===e?(e=a.indexOf(t),this._selectChild(s.size+e+2,!1)):this._selectChild(e+1,!1)}},this.handleHeaderClick=()=>{this.column.scrollTop()},this.setExpansion=t=>{this.setState({isExpanded:t})},this.setRef=t=>{this.node=t},this.setColumnRef=t=>{this.column=t},this.onFullScreenChange=()=>{this.setState({fullscreen:Object(W.d)()})}}componentDidMount(){Object(W.a)(this.onFullScreenChange),this.props.dispatch(Object(f.j)(this.props.params.statusId));const{status:t,ancestorsIds:e}=this.props;if(t&&e&&e.size>0){const t=this.node.querySelectorAll(".focusable")[e.size-1];window.requestAnimationFrame((()=>{t.scrollIntoView(!0)}))}}static getDerivedStateFromProps(t,e){let s={},a=!1;t.params.statusId&&e.statusId!==t.params.statusId&&(t.dispatch(Object(f.j)(t.params.statusId)),s.threadExpanded=void 0,s.statusId=t.params.statusId,a=!0);const i=t.settings.getIn(["media","reveal_behind_cw"]);return i!==e.revealBehindCW&&(s.revealBehindCW=i,i&&(s.showMedia=Object(G.b)(t.status,t.settings)),a=!0),t.status&&e.loadedStatusId!==t.status.get("id")&&(s.showMedia=Object(G.b)(t.status,t.settings),s.loadedStatusId=t.status.get("id"),s.isExpanded=Object(Y.b)(t.settings,t.status),a=!0),a?s:null}_selectChild(t,e){const s=this.node,a=s.querySelectorAll(".focusable")[t];a&&(e&&s.scrollTop>a.offsetTop?a.scrollIntoView(!0):!e&&s.scrollTop+s.clientHeight<a.offsetTop+a.offsetHeight&&a.scrollIntoView(!1),a.focus())}renderChildren(t){return t.map((t=>Object(o.a)(q.a,{id:t,expanded:this.state.threadExpanded,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,contextType:"thread"},t)))}componentDidUpdate(t){if(this.props.params.statusId&&(this.props.params.statusId!==t.params.statusId||t.ancestorsIds.size<this.props.ancestorsIds.size)){const{status:t,ancestorsIds:e}=this.props;if(t&&e&&e.size>0){const t=this.node.querySelectorAll(".focusable")[e.size-1];window.requestAnimationFrame((()=>{t.scrollIntoView(!0)}))}}}componentWillUnmount(){Object(W.b)(this.onFullScreenChange)}render(){let t,e;const{status:s,settings:a,ancestorsIds:i,descendantsIds:n,intl:d,domain:r,multiColumn:c,usingPiP:h}=this.props,{fullscreen:u}=this.state;if(null===s)return Object(o.a)(D.a,{},void 0,Object(o.a)(z.a,{multiColumn:c}),Object(o.a)(v.a,{}));const g=a.getIn(["content_warnings","shared_state"])?!s.get("hidden"):this.state.isExpanded;i&&i.size>0&&(t=Object(o.a)("div",{},void 0,this.renderChildren(i))),n&&n.size>0&&(e=Object(o.a)("div",{},void 0,this.renderChildren(n)));const m={moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,reply:this.handleHotkeyReply,favourite:this.handleHotkeyFavourite,boost:this.handleHotkeyBoost,bookmark:this.handleHotkeyBookmark,mention:this.handleHotkeyMention,openProfile:this.handleHotkeyOpenProfile,toggleSpoiler:this.handleToggleHidden,toggleSensitive:this.handleHotkeyToggleSensitive,openMedia:this.handleHotkeyOpenMedia};return l.a.createElement(D.a,{bindToDocument:!c,ref:this.setColumnRef,label:d.formatMessage(X.detailedStatus)},Object(o.a)(U.a,{icon:"comment",title:d.formatMessage(X.tootHeading),onClick:this.handleHeaderClick,showBackButton:!0,multiColumn:c,extraButton:Object(o.a)("button",{className:"column-header__button",title:d.formatMessage(g?X.hideAll:X.revealAll),"aria-label":d.formatMessage(g?X.hideAll:X.revealAll),onClick:this.handleToggleAll,"aria-pressed":g?"true":"false"},void 0,Object(o.a)(Q.a,{id:g?"eye":"eye-slash"}))}),Object(o.a)(A.a,{scrollKey:"thread"},void 0,l.a.createElement("div",{className:p()("scrollable","detailed-status__wrapper",{fullscreen:u}),ref:this.setRef},t,Object(o.a)(J.HotKeys,{handlers:m},void 0,Object(o.a)("div",{className:"focusable",tabIndex:"0","aria-label":Object(G.c)(d,s,!1,g)},void 0,Object(o.a)(k.a,{status:s,settings:a,onOpenVideo:this.handleOpenVideo,onOpenMedia:this.handleOpenMedia,expanded:g,onToggleHidden:this.handleToggleHidden,domain:r,showMedia:this.state.showMedia,onToggleMediaVisibility:this.handleToggleMediaVisibility,usingPiP:h},"details-"+s.get("id")),Object(o.a)(x,{status:s,onReply:this.handleReplyClick,onFavourite:this.handleFavouriteClick,onReblog:this.handleReblogClick,onBookmark:this.handleBookmarkClick,onDelete:this.handleDeleteClick,onEdit:this.handleEditClick,onDirect:this.handleDirectClick,onMention:this.handleMentionClick,onMute:this.handleMuteClick,onMuteConversation:this.handleConversationMuteClick,onBlock:this.handleBlockClick,onReport:this.handleReport,onPin:this.handlePin,onEmbed:this.handleEmbed},"action-bar-"+s.get("id")))),e)))}}).contextTypes={router:h.a.object},H.propTypes={params:h.a.object.isRequired,dispatch:h.a.func.isRequired,status:m.a.map,settings:m.a.map.isRequired,ancestorsIds:m.a.list,descendantsIds:m.a.list,intl:h.a.object.isRequired,askReplyConfirmation:h.a.bool,multiColumn:h.a.bool,domain:h.a.string.isRequired,usingPiP:h.a.bool},R=H))||R)||R)}}]);
//# sourceMappingURL=status-936d777ba246b28b5c45.chunk.js.map