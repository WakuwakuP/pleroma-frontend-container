(window.webpackJsonp=window.webpackJsonp||[]).push([[375],{1020:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Q}));var s=a(0),o=a(1),i=a.n(o),l=a(12),c=a(966),d=a(24),n=a(404),r=a(3),u=a.n(r),h=a(16),p=a.n(h),g=a(207),b=a(4),m=a(2),O=a(18),j=a(32),v=a(98),_=a(7),f=a.n(_);var k,C=()=>Object(s.a)("svg",{width:"14",height:"11",viewBox:"0 0 14 11"},void 0,Object(s.a)("path",{d:"M11.264 0L5.26 6.004 2.103 2.847 0 4.95l5.26 5.26 8.108-8.107L11.264 0",fill:"currentColor",fillRule:"evenodd"}));class y extends i.a.PureComponent{constructor(){super(...arguments),this.handleKeyPress=e=>{const{value:t,checked:a,onToggle:s}=this.props;"Enter"!==e.key&&" "!==e.key||(e.stopPropagation(),e.preventDefault(),s(t,!a))},this.handleChange=e=>{const{value:t,onToggle:a}=this.props;a(t,e.target.checked)}}render(){const{name:e,value:t,checked:a,label:o,labelComponent:i,description:l,multiple:c}=this.props;return Object(s.a)("label",{className:"dialog-option poll__option selectable"},void 0,Object(s.a)("input",{type:c?"checkbox":"radio",name:e,value:t,checked:a,onChange:this.handleChange}),Object(s.a)("span",{className:f()("poll__input",{active:a,checkbox:c}),tabIndex:"0",role:"radio",onKeyPress:this.handleKeyPress,"aria-checked":a,"aria-label":o},void 0,a&&Object(s.a)(C,{})),i||Object(s.a)("span",{className:"poll__option__text"},void 0,Object(s.a)("strong",{},void 0,o),l))}}const w=Object(b.f)({dislike:{id:"report.reasons.dislike",defaultMessage:"I don't like it"},dislike_description:{id:"report.reasons.dislike_description",defaultMessage:"It is not something you want to see"},spam:{id:"report.reasons.spam",defaultMessage:"It's spam"},spam_description:{id:"report.reasons.spam_description",defaultMessage:"Malicious links, fake engagement, or repetitive replies"},violation:{id:"report.reasons.violation",defaultMessage:"It violates server rules"},violation_description:{id:"report.reasons.violation_description",defaultMessage:"You are aware that it breaks specific rules"},other:{id:"report.reasons.other",defaultMessage:"It's something else"},other_description:{id:"report.reasons.other_description",defaultMessage:"The issue does not fit into other categories"},status:{id:"report.category.title_status",defaultMessage:"post"},account:{id:"report.category.title_account",defaultMessage:"profile"}});let N=Object(l.connect)((e=>({rules:e.get("rules")})))(k=Object(b.g)(k=class extends i.a.PureComponent{constructor(){super(...arguments),this.handleNextClick=()=>{const{onNextStep:e,category:t}=this.props;switch(t){case"dislike":e("thanks");break;case"violation":e("rules");break;default:e("statuses")}},this.handleCategoryToggle=(e,t)=>{const{onChangeCategory:a}=this.props;t&&a(e)}}render(){const{category:e,startedFrom:t,rules:a,intl:o}=this.props,l=a.size>0?["dislike","spam","violation","other"]:["dislike","spam","other"];return Object(s.a)(i.a.Fragment,{},void 0,Object(s.a)("h3",{className:"report-dialog-modal__title"},void 0,Object(s.a)(b.b,{id:"report.category.title",defaultMessage:"Tell us what's going on with this {type}",values:{type:o.formatMessage(w[t])}})),Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,Object(s.a)(b.b,{id:"report.category.subtitle",defaultMessage:"Choose the best match"})),Object(s.a)("div",{},void 0,l.map((t=>Object(s.a)(y,{name:"category",value:t,checked:e===t,onToggle:this.handleCategoryToggle,label:o.formatMessage(w[t]),description:o.formatMessage(w[t+"_description"])},t)))),Object(s.a)("div",{className:"flex-spacer"}),Object(s.a)("div",{className:"report-dialog-modal__actions"},void 0,Object(s.a)(v.a,{onClick:this.handleNextClick,disabled:null===e},void 0,Object(s.a)(b.b,{id:"report.next",defaultMessage:"Next"}))))}})||k)||k;var S=a(264),M=a(100),x=a(136),I=a(93),T=a(1447);class R extends i.a.PureComponent{constructor(){super(...arguments),this.handleStatusesToggle=(e,t)=>{const{onToggle:a}=this.props;a(e,t)}}render(){const{status:e,checked:t}=this.props;if(e.get("reblog"))return null;const a=Object(s.a)("div",{className:"status-check-box__status poll__option__text"},void 0,Object(s.a)("div",{className:"detailed-status__display-name"},void 0,Object(s.a)("div",{className:"detailed-status__display-avatar"},void 0,Object(s.a)(M.a,{account:e.get("account"),size:46})),Object(s.a)("div",{},void 0,Object(s.a)(x.a,{account:e.get("account")})," Â· ",Object(s.a)(I.default,{timestamp:e.get("created_at")}))),Object(s.a)(S.a,{status:e}),Object(s.a)(T.a,{status:e}));return Object(s.a)(y,{name:"status_ids",value:e.get("id"),checked:t,onToggle:this.handleStatusesToggle,label:e.get("search_index"),labelComponent:a,multiple:!0})}}var F,P=Object(l.connect)((()=>{const e=Object(g.h)();return(t,a)=>{let{id:s}=a;return{status:e(t,{id:s})}}}))(R),K=a(281);let D=Object(l.connect)(((e,t)=>{let{accountId:a}=t;return{availableStatusIds:Object(m.OrderedSet)(e.getIn(["timelines","account:"+a+":with_replies","items"])),isLoading:e.getIn(["timelines","account:"+a+":with_replies","isLoading"])}}))(F=class extends i.a.PureComponent{constructor(){super(...arguments),this.handleNextClick=()=>{const{onNextStep:e}=this.props;e("comment")}}render(){const{availableStatusIds:e,selectedStatusIds:t,onToggle:a,isLoading:o}=this.props;return Object(s.a)(i.a.Fragment,{},void 0,Object(s.a)("h3",{className:"report-dialog-modal__title"},void 0,Object(s.a)(b.b,{id:"report.statuses.title",defaultMessage:"Are there any posts that back up this report?"})),Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,Object(s.a)(b.b,{id:"report.statuses.subtitle",defaultMessage:"Select all that apply"})),Object(s.a)("div",{className:"report-dialog-modal__statuses"},void 0,o?Object(s.a)(K.b,{}):e.union(t).map((e=>Object(s.a)(P,{id:e,checked:t.includes(e),onToggle:a},e)))),Object(s.a)("div",{className:"flex-spacer"}),Object(s.a)("div",{className:"report-dialog-modal__actions"},void 0,Object(s.a)(v.a,{onClick:this.handleNextClick},void 0,Object(s.a)(b.b,{id:"report.next",defaultMessage:"Next"}))))}})||F;var B;let z=Object(l.connect)((e=>({rules:e.get("rules")})))(B=class extends i.a.PureComponent{constructor(){super(...arguments),this.handleNextClick=()=>{const{onNextStep:e}=this.props;e("statuses")},this.handleRulesToggle=(e,t)=>{const{onToggle:a}=this.props;a(e,t)}}render(){const{rules:e,selectedRuleIds:t}=this.props;return Object(s.a)(i.a.Fragment,{},void 0,Object(s.a)("h3",{className:"report-dialog-modal__title"},void 0,Object(s.a)(b.b,{id:"report.rules.title",defaultMessage:"Which rules are being violated?"})),Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,Object(s.a)(b.b,{id:"report.rules.subtitle",defaultMessage:"Select all that apply"})),Object(s.a)("div",{},void 0,e.map((e=>Object(s.a)(y,{name:"rule_ids",value:e.get("id"),checked:t.includes(e.get("id")),onToggle:this.handleRulesToggle,label:e.get("text"),multiple:!0},e.get("id"))))),Object(s.a)("div",{className:"flex-spacer"}),Object(s.a)("div",{className:"report-dialog-modal__actions"},void 0,Object(s.a)(v.a,{onClick:this.handleNextClick,disabled:t.size<1},void 0,Object(s.a)(b.b,{id:"report.next",defaultMessage:"Next"}))))}})||B;var L,U=a(960),q=a.n(U);const Y=Object(b.f)({placeholder:{id:"report.placeholder",defaultMessage:"Type or paste additional comments"}});let A=Object(b.g)(L=class extends i.a.PureComponent{constructor(){super(...arguments),this.handleClick=()=>{const{onSubmit:e}=this.props;e()},this.handleChange=e=>{const{onChangeComment:t}=this.props;t(e.target.value)},this.handleKeyDown=e=>{13===e.keyCode&&(e.ctrlKey||e.metaKey)&&this.handleClick()},this.handleForwardChange=e=>{const{onChangeForward:t}=this.props;t(e.target.checked)}}render(){const{comment:e,isRemote:t,forward:a,domain:o,isSubmitting:l,intl:c}=this.props;return Object(s.a)(i.a.Fragment,{},void 0,Object(s.a)("h3",{className:"report-dialog-modal__title"},void 0,Object(s.a)(b.b,{id:"report.comment.title",defaultMessage:"Is there anything else you think we should know?"})),Object(s.a)("textarea",{className:"report-dialog-modal__textarea",placeholder:c.formatMessage(Y.placeholder),value:e,onChange:this.handleChange,onKeyDown:this.handleKeyDown,disabled:l}),t&&Object(s.a)(i.a.Fragment,{},void 0,Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,Object(s.a)(b.b,{id:"report.forward_hint",defaultMessage:"The account is from another server. Send an anonymized copy of the report there as well?"})),Object(s.a)("label",{className:"report-dialog-modal__toggle"},void 0,Object(s.a)(q.a,{checked:a,disabled:l,onChange:this.handleForwardChange}),Object(s.a)(b.b,{id:"report.forward",defaultMessage:"Forward to {target}",values:{target:o}}))),Object(s.a)("div",{className:"flex-spacer"}),Object(s.a)("div",{className:"report-dialog-modal__actions"},void 0,Object(s.a)(v.a,{onClick:this.handleClick,disabled:l},void 0,Object(s.a)(b.b,{id:"report.submit",defaultMessage:"Submit report"}))))}})||L;var J,W=a(13);let E=Object(l.connect)((()=>({})))(J=class extends i.a.PureComponent{constructor(){super(...arguments),this.handleCloseClick=()=>{const{onClose:e}=this.props;e()},this.handleUnfollowClick=()=>{const{dispatch:e,account:t,onClose:a}=this.props;e(Object(W.Z)(t.get("id"))),a()},this.handleMuteClick=()=>{const{dispatch:e,account:t,onClose:a}=this.props;e(Object(W.U)(t.get("id"))),a()},this.handleBlockClick=()=>{const{dispatch:e,account:t,onClose:a}=this.props;e(Object(W.J)(t.get("id"))),a()}}render(){const{account:e,submitted:t}=this.props;return Object(s.a)(i.a.Fragment,{},void 0,Object(s.a)("h3",{className:"report-dialog-modal__title"},void 0,t?Object(s.a)(b.b,{id:"report.thanks.title_actionable",defaultMessage:"Thanks for reporting, we'll look into this."}):Object(s.a)(b.b,{id:"report.thanks.title",defaultMessage:"Don't want to see this?"})),Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,t?Object(s.a)(b.b,{id:"report.thanks.take_action_actionable",defaultMessage:"While we review this, you can take action against @{name}:",values:{name:e.get("username")}}):Object(s.a)(b.b,{id:"report.thanks.take_action",defaultMessage:"Here are your options for controlling what you see on Mastodon:"})),e.getIn(["relationship","following"])&&Object(s.a)(i.a.Fragment,{},void 0,Object(s.a)("h4",{className:"report-dialog-modal__subtitle"},void 0,Object(s.a)(b.b,{id:"report.unfollow",defaultMessage:"Unfollow @{name}",values:{name:e.get("username")}})),Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,Object(s.a)(b.b,{id:"report.unfollow_explanation",defaultMessage:"You are following this account. To not see their posts in your home feed anymore, unfollow them."})),Object(s.a)(v.a,{secondary:!0,onClick:this.handleUnfollowClick},void 0,Object(s.a)(b.b,{id:"account.unfollow",defaultMessage:"Unfollow"})),Object(s.a)("hr",{})),Object(s.a)("h4",{className:"report-dialog-modal__subtitle"},void 0,Object(s.a)(b.b,{id:"account.mute",defaultMessage:"Mute @{name}",values:{name:e.get("username")}})),Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,Object(s.a)(b.b,{id:"report.mute_explanation",defaultMessage:"You will not see their posts. They can still follow you and see your posts and will not know that they are muted."})),Object(s.a)(v.a,{secondary:!0,onClick:this.handleMuteClick},void 0,e.getIn(["relationship","muting"])?Object(s.a)(b.b,{id:"account.muted",defaultMessage:"Muted"}):Object(s.a)(b.b,{id:"report.mute",defaultMessage:"Mute"})),Object(s.a)("hr",{}),Object(s.a)("h4",{className:"report-dialog-modal__subtitle"},void 0,Object(s.a)(b.b,{id:"account.block",defaultMessage:"Block @{name}",values:{name:e.get("username")}})),Object(s.a)("p",{className:"report-dialog-modal__lead"},void 0,Object(s.a)(b.b,{id:"report.block_explanation",defaultMessage:"You will not see their posts. They will not be able to see your posts or follow you. They will be able to tell that they are blocked."})),Object(s.a)(v.a,{secondary:!0,onClick:this.handleBlockClick},void 0,e.getIn(["relationship","blocking"])?Object(s.a)(b.b,{id:"account.blocked",defaultMessage:"Blocked"}):Object(s.a)(b.b,{id:"report.block",defaultMessage:"Block"})),Object(s.a)("div",{className:"flex-spacer"}),Object(s.a)("div",{className:"report-dialog-modal__actions"},void 0,Object(s.a)(v.a,{onClick:this.handleCloseClick},void 0,Object(s.a)(b.b,{id:"report.close",defaultMessage:"Done"}))))}})||J;var H,Z;const G=Object(b.f)({close:{id:"lightbox.close",defaultMessage:"Close"}});let Q=Object(l.connect)((()=>{const e=Object(g.d)();return(t,a)=>{let{accountId:s}=a;return{account:e(t,s)}}}))(H=Object(b.g)(((Z=class extends O.a{constructor(){super(...arguments),this.state={step:"category",selectedStatusIds:Object(m.OrderedSet)(this.props.statusId?[this.props.statusId]:[]),comment:"",category:null,selectedRuleIds:Object(m.OrderedSet)(),forward:!0,isSubmitting:!1,isSubmitted:!1},this.handleSubmit=()=>{const{dispatch:e,accountId:t}=this.props,{selectedStatusIds:a,comment:s,category:o,selectedRuleIds:i,forward:l}=this.state;this.setState({isSubmitting:!0}),e(Object(c.b)({account_id:t,status_ids:a.toArray(),comment:s,forward:l,category:o,rule_ids:i.toArray()},this.handleSuccess,this.handleFail))},this.handleSuccess=()=>{this.setState({isSubmitting:!1,isSubmitted:!0,step:"thanks"})},this.handleFail=()=>{this.setState({isSubmitting:!1})},this.handleStatusToggle=(e,t)=>{const{selectedStatusIds:a}=this.state;t?this.setState({selectedStatusIds:a.add(e)}):this.setState({selectedStatusIds:a.remove(e)})},this.handleRuleToggle=(e,t)=>{const{selectedRuleIds:a}=this.state;t?this.setState({selectedRuleIds:a.add(e)}):this.setState({selectedRuleIds:a.remove(e)})},this.handleChangeCategory=e=>{this.setState({category:e})},this.handleChangeComment=e=>{this.setState({comment:e})},this.handleChangeForward=e=>{this.setState({forward:e})},this.handleNextStep=e=>{this.setState({step:e})}}componentDidMount(){const{dispatch:e,accountId:t}=this.props;e(Object(d.r)(t,{withReplies:!0})),e(Object(n.b)())}render(){const{accountId:e,account:t,intl:a,onClose:o}=this.props;if(!t)return null;const{step:i,selectedStatusIds:l,selectedRuleIds:c,comment:d,forward:n,category:r,isSubmitting:u,isSubmitted:h}=this.state,p=t.get("acct").split("@")[1],g=!!p;let m;switch(i){case"category":m=Object(s.a)(N,{onNextStep:this.handleNextStep,startedFrom:this.props.statusId?"status":"account",category:r,onChangeCategory:this.handleChangeCategory});break;case"rules":m=Object(s.a)(z,{onNextStep:this.handleNextStep,selectedRuleIds:c,onToggle:this.handleRuleToggle});break;case"statuses":m=Object(s.a)(D,{onNextStep:this.handleNextStep,accountId:e,selectedStatusIds:l,onToggle:this.handleStatusToggle});break;case"comment":m=Object(s.a)(A,{onSubmit:this.handleSubmit,isSubmitting:u,isRemote:g,comment:d,forward:n,domain:p,onChangeComment:this.handleChangeComment,onChangeForward:this.handleChangeForward});break;case"thanks":m=Object(s.a)(E,{submitted:h,account:t,onClose:o})}return Object(s.a)("div",{className:"modal-root__modal report-dialog-modal"},void 0,Object(s.a)("div",{className:"report-modal__target"},void 0,Object(s.a)(j.a,{className:"report-modal__close",title:a.formatMessage(G.close),icon:"times",onClick:o,size:20}),Object(s.a)(b.b,{id:"report.target",defaultMessage:"Report {target}",values:{target:Object(s.a)("strong",{},void 0,t.get("acct"))}})),Object(s.a)("div",{className:"report-dialog-modal__container"},void 0,m))}}).propTypes={accountId:u.a.string.isRequired,statusId:u.a.string,dispatch:u.a.func.isRequired,intl:u.a.object.isRequired,account:p.a.map.isRequired},H=Z))||H)||H}}]);
//# sourceMappingURL=report_modal-dbe7edb530dae69d468d.chunk.js.map