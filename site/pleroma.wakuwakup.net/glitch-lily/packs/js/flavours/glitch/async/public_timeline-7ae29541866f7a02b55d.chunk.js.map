{"version":3,"sources":["webpack:///app/javascript/builds/infra/glitch-lily/app/javascript/flavours/glitch/features/public_timeline/components/column_settings.js","webpack:///app/javascript/builds/infra/glitch-lily/app/javascript/flavours/glitch/features/public_timeline/containers/column_settings_container.js","webpack:///app/javascript/builds/infra/glitch-lily/app/javascript/flavours/glitch/features/public_timeline/index.js"],"names":["ColumnSettings","injectIntl","React","PureComponent","render","settings","onChange","this","props","className","settingPath","label","id","defaultMessage","getIn","connect","state","columnId","uuid","columns","index","findIndex","c","get","dispatch","key","checked","changeColumnParams","changeSetting","messages","defineMessages","title","PublicTimeline","onlyMedia","onlyRemote","allowLocalOnly","timelineState","hasUnread","handlePin","removeColumn","addColumn","other","handleMove","dir","moveColumn","handleHeaderClick","column","scrollTop","setRef","handleLoadMore","maxId","expandPublicTimeline","componentDidMount","disconnect","connectPublicStream","componentDidUpdate","prevProps","componentWillUnmount","intl","multiColumn","pinned","bindToDocument","ref","name","formatMessage","icon","active","onPin","onMove","onClick","timelineId","onLoadMore","trackScroll","scrollKey","emptyMessage","defaultProps","contextTypes","router","PropTypes","object"],"mappings":"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","file":"js/flavours/glitch/async/public_timeline-7ae29541866f7a02b55d.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport { injectIntl, FormattedMessage } from 'react-intl';\nimport SettingToggle from '../../notifications/components/setting_toggle';\n\nexport default @injectIntl\nclass ColumnSettings extends React.PureComponent {\n\n  static propTypes = {\n    settings: ImmutablePropTypes.map.isRequired,\n    onChange: PropTypes.func.isRequired,\n    intl: PropTypes.object.isRequired,\n    columnId: PropTypes.string,\n  };\n\n  render () {\n    const { settings, onChange } = this.props;\n\n    return (\n      <div>\n        <div className='column-settings__row'>\n          <SettingToggle settings={settings} settingPath={['other', 'onlyMedia']} onChange={onChange} label={<FormattedMessage id='community.column_settings.media_only' defaultMessage='Media only' />} />\n          <SettingToggle settings={settings} settingPath={['other', 'onlyRemote']} onChange={onChange} label={<FormattedMessage id='community.column_settings.remote_only' defaultMessage='Remote only' />} />\n          {!settings.getIn(['other', 'onlyRemote']) && <SettingToggle settings={settings} settingPath={['other', 'allowLocalOnly']} onChange={onChange} label={<FormattedMessage id='community.column_settings.allow_local_only' defaultMessage='Show local-only toots' />} />}\n        </div>\n      </div>\n    );\n  }\n\n}\n","import { connect } from 'react-redux';\nimport ColumnSettings from '../components/column_settings';\nimport { changeSetting } from 'flavours/glitch/actions/settings';\nimport { changeColumnParams } from 'flavours/glitch/actions/columns';\n \nconst mapStateToProps = (state, { columnId }) => {\n  const uuid = columnId;\n  const columns = state.getIn(['settings', 'columns']);\n  const index = columns.findIndex(c => c.get('uuid') === uuid);\n\n  return {\n    settings: (uuid && index >= 0) ? columns.get(index).get('params') : state.getIn(['settings', 'public']),\n  };\n};\n\nconst mapDispatchToProps = (dispatch, { columnId }) => {\n  return {\n    onChange (key, checked) {\n      if (columnId) {\n        dispatch(changeColumnParams(columnId, key, checked));\n      } else {\n        dispatch(changeSetting(['public', ...key], checked));\n      }\n    },\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColumnSettings);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { defineMessages, injectIntl, FormattedMessage } from 'react-intl';\nimport PropTypes from 'prop-types';\nimport StatusListContainer from 'flavours/glitch/features/ui/containers/status_list_container';\nimport Column from 'flavours/glitch/components/column';\nimport ColumnHeader from 'flavours/glitch/components/column_header';\nimport { expandPublicTimeline } from 'flavours/glitch/actions/timelines';\nimport { addColumn, removeColumn, moveColumn } from 'flavours/glitch/actions/columns';\nimport ColumnSettingsContainer from './containers/column_settings_container';\nimport { connectPublicStream } from 'flavours/glitch/actions/streaming';\n\nconst messages = defineMessages({\n  title: { id: 'column.public', defaultMessage: 'Federated timeline' },\n});\n\nconst mapStateToProps = (state, { columnId }) => {\n  const uuid = columnId;\n  const columns = state.getIn(['settings', 'columns']);\n  const index = columns.findIndex(c => c.get('uuid') === uuid);\n  const onlyMedia = (columnId && index >= 0) ? columns.get(index).getIn(['params', 'other', 'onlyMedia']) : state.getIn(['settings', 'public', 'other', 'onlyMedia']);\n  const onlyRemote = (columnId && index >= 0) ? columns.get(index).getIn(['params', 'other', 'onlyRemote']) : state.getIn(['settings', 'public', 'other', 'onlyRemote']);\n  const allowLocalOnly = (columnId && index >= 0) ? columns.get(index).getIn(['params', 'other', 'allowLocalOnly']) : state.getIn(['settings', 'public', 'other', 'allowLocalOnly']);\n  const timelineState = state.getIn(['timelines', `public${onlyMedia ? ':media' : ''}`]);\n\n  return {\n    hasUnread: !!timelineState && timelineState.get('unread') > 0,\n    onlyMedia,\n    onlyRemote,\n    allowLocalOnly,\n  };\n};\n\nexport default @connect(mapStateToProps)\n@injectIntl\nclass PublicTimeline extends React.PureComponent {\n\n  static defaultProps = {\n    onlyMedia: false,\n  };\n\n  static contextTypes = {\n    router: PropTypes.object,\n  };\n\n  static propTypes = {\n    dispatch: PropTypes.func.isRequired,\n    intl: PropTypes.object.isRequired,\n    columnId: PropTypes.string,\n    multiColumn: PropTypes.bool,\n    hasUnread: PropTypes.bool,\n    onlyMedia: PropTypes.bool,\n    onlyRemote: PropTypes.bool,\n    allowLocalOnly: PropTypes.bool,\n  };\n\n  handlePin = () => {\n    const { columnId, dispatch, onlyMedia, onlyRemote, allowLocalOnly } = this.props;\n\n    if (columnId) {\n      dispatch(removeColumn(columnId));\n    } else {\n      dispatch(addColumn(onlyRemote ? 'REMOTE' : 'PUBLIC', { other: { onlyMedia, onlyRemote, allowLocalOnly } }));\n    }\n  }\n\n  handleMove = (dir) => {\n    const { columnId, dispatch } = this.props;\n    dispatch(moveColumn(columnId, dir));\n  }\n\n  handleHeaderClick = () => {\n    this.column.scrollTop();\n  }\n\n  componentDidMount () {\n    const { dispatch, onlyMedia, onlyRemote, allowLocalOnly } = this.props;\n\n    dispatch(expandPublicTimeline({ onlyMedia, onlyRemote, allowLocalOnly }));\n    this.disconnect = dispatch(connectPublicStream({ onlyMedia, onlyRemote, allowLocalOnly }));\n  }\n\n  componentDidUpdate (prevProps) {\n    if (prevProps.onlyMedia !== this.props.onlyMedia || prevProps.onlyRemote !== this.props.onlyRemote || prevProps.allowLocalOnly !== this.props.allowLocalOnly) {\n      const { dispatch, onlyMedia, onlyRemote, allowLocalOnly } = this.props;\n\n      this.disconnect();\n      dispatch(expandPublicTimeline({ onlyMedia, onlyRemote, allowLocalOnly }));\n      this.disconnect = dispatch(connectPublicStream({ onlyMedia, onlyRemote, allowLocalOnly }));\n    }\n  }\n\n  componentWillUnmount () {\n    if (this.disconnect) {\n      this.disconnect();\n      this.disconnect = null;\n    }\n  }\n\n  setRef = c => {\n    this.column = c;\n  }\n\n  handleLoadMore = maxId => {\n    const { dispatch, onlyMedia, onlyRemote, allowLocalOnly } = this.props;\n\n    dispatch(expandPublicTimeline({ maxId, onlyMedia, onlyRemote, allowLocalOnly }));\n  }\n\n  render () {\n    const { intl, columnId, hasUnread, multiColumn, onlyMedia, onlyRemote, allowLocalOnly } = this.props;\n    const pinned = !!columnId;\n\n    return (\n      <Column bindToDocument={!multiColumn} ref={this.setRef} name='federated' label={intl.formatMessage(messages.title)}>\n        <ColumnHeader\n          icon='globe'\n          active={hasUnread}\n          title={intl.formatMessage(messages.title)}\n          onPin={this.handlePin}\n          onMove={this.handleMove}\n          onClick={this.handleHeaderClick}\n          pinned={pinned}\n          multiColumn={multiColumn}\n        >\n          <ColumnSettingsContainer columnId={columnId} />\n        </ColumnHeader>\n\n        <StatusListContainer\n          timelineId={`public${onlyRemote ? ':remote' : (allowLocalOnly ? ':allow_local_only' : '')}${onlyMedia ? ':media' : ''}`}\n          onLoadMore={this.handleLoadMore}\n          trackScroll={!pinned}\n          scrollKey={`public_timeline-${columnId}`}\n          emptyMessage={<FormattedMessage id='empty_column.public' defaultMessage='There is nothing here! Write something publicly, or manually follow users from other servers to fill it up' />}\n          bindToDocument={!multiColumn}\n        />\n      </Column>\n    );\n  }\n\n}\n"],"sourceRoot":""}